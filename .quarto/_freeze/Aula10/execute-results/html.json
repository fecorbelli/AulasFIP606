{
  "hash": "b90858562e9ffa6db5abf1bb55eaaec5",
  "result": {
    "markdown": "---\ntitle: \"Aula 10\"\nformat: html\neditor: visual\nmessage: false\nwarning: false\n---\n\n\n# Análise de correlação\n\nA análise de correlação permite verificar se as variáveis estão positivamente correlacionadas (quando uma aumenta, a outra também aumenta), negativamente correlacionadas (quando uma aumenta, a outra diminui) ou se não há correlação entre elas.\n\n### Importação dos dados\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(gsheet)\n\nimgs <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=373270992\")\n```\n:::\n\n\n### Visualização e ajuste ao modelo linear\n\n\n::: {.cell}\n\n```{.r .cell-code}\nimgs %>% \n  ggplot(aes(Assess, LeafDoctor)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](Aula10_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\nimgs %>% \n  ggplot(aes(Assess, ImageJ)) +\n  geom_point() +\n  geom_smooth(method = \"lm\")\n```\n\n::: {.cell-output-display}\n![](Aula10_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n:::\n\n\n### Coeficiente de correlação de Pearson\n\nPodemos verificar a correlação entre variáveis atraves da função `cor.test()` ou da função `corgraph()` do pacote **AgroR**.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nimgs2 <- imgs %>% \n  select(3:5)\n\nlibrary(dplyr)\nlibrary(AgroR)\ncorgraph(imgs2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        Var1       Var2       cor            p\n2 LeafDoctor     Assess 0.9666367 5.972544e-42\n3     ImageJ     Assess 0.9776918 8.143613e-48\n6     ImageJ LeafDoctor 0.9797478 3.144091e-49\n```\n:::\n\n::: {.cell-output-display}\n![](Aula10_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\ncor.test(imgs$Assess, imgs$LeafDoctor)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPearson's product-moment correlation\n\ndata:  imgs$Assess and imgs$LeafDoctor\nt = 31.119, df = 68, p-value < 2.2e-16\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.9466882 0.9792005\nsample estimates:\n      cor \n0.9666367 \n```\n:::\n\n```{.r .cell-code}\n# testa se coeficiente é zero (h0)\ncor(imgs$Assess, imgs$LeafDoctor)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.9666367\n```\n:::\n:::\n\n\nInterpretação: correlação forte Quanto maior a correlação, menor p-valor\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(corrplot)\n\ncor_imgs2 <- cor(imgs2)\ncorrplot(cor_imgs2, method = 'number', type = \"lower\", diag = FALSE)\n```\n\n::: {.cell-output-display}\n![](Aula10_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n## Análise de correlação com outros conjuntos de dados\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncampo <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=866852711\")\n\ncampo2 <- campo %>% \n  select(DFC, FER, PROD)\n\ncorgraph(campo2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Var1 Var2        cor            p\n2  FER  DFC  0.9316978 9.864101e-15\n3 PROD  DFC -0.6928161 1.110652e-05\n6 PROD  FER -0.6258321 1.277444e-04\n```\n:::\n\n::: {.cell-output-display}\n![](Aula10_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\ncampo %>% \n  ggplot(aes(DFC, PROD)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](Aula10_files/figure-html/unnamed-chunk-5-2.png){width=672}\n:::\n:::\n\n\n# Análise de regressão não-linear\n\n### Importação dos dados\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(gsheet)\nestande <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=401662555\")\n```\n:::\n\n\n### Visualização com ajuste linear e quadrático\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexp2 <- estande %>% \n  filter(exp == 2)\n\nexp2 %>% \n  ggplot (aes(trat, nplants)) +\n  geom_point() +\n  ylim(0,100) +\n  geom_smooth(method = \"lm\",\n              se = FALSE,\n              formula = y ~ poly(x,2),\n              color = \"black\") +\n  geom_smooth(method = \"lm\",\n              se = FALSE)\n```\n\n::: {.cell-output-display}\n![](Aula10_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n## Análise de regressão com modelo linear - primeira ordem\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm2 <- lm(nplants ~ trat,\n          data = exp2)\n\nsummary(lm2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = nplants ~ trat, data = exp2)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-25.7816  -7.7150   0.5653   8.1929  19.2184 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  60.9857     3.6304  16.798 4.93e-14 ***\ntrat         -0.7007     0.1605  -4.365 0.000247 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.95 on 22 degrees of freedom\nMultiple R-squared:  0.4641,\tAdjusted R-squared:  0.4398 \nF-statistic: 19.05 on 1 and 22 DF,  p-value: 0.0002473\n```\n:::\n:::\n\n\n## Análise de regressão com modelo quadratico - segunda ordem\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexp2$trat2 <- exp2$trat^2\n\nlm3 <- lm(nplants ~ trat + trat2,\n          data = exp2)\n\nsummary(lm3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = nplants ~ trat + trat2, data = exp2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-25.439  -6.019   1.789   8.016  19.561 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 66.30156    4.42097  14.997 1.08e-12 ***\ntrat        -1.77720    0.58467  -3.040  0.00623 ** \ntrat2        0.02223    0.01166   1.906  0.07036 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 12.24 on 21 degrees of freedom\nMultiple R-squared:  0.5432,\tAdjusted R-squared:  0.4997 \nF-statistic: 12.49 on 2 and 21 DF,  p-value: 0.0002675\n```\n:::\n\n```{.r .cell-code}\nAIC(lm2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 194.9597\n```\n:::\n\n```{.r .cell-code}\nAIC(lm3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 193.1284\n```\n:::\n:::\n\n\nInterpretação: Maior o valor de r2 no segundo modelo, então o modelo quadrático explica melhor a relação entre variáveis. Função = 66,3 - 1,77\\* TRAT + 0,02\\* TRAT2\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(AgroR)\nwith(exp2, polynomial(trat, nplants, grau = 2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n----------------------------------------------------\nRegression Models\n----------------------------------------------------\n               Estimate Std. Error   t value     Pr(>|t|)\n(Intercept) 66.30156250 4.42096799 14.997069 1.079972e-12\ntrat        -1.77719814 0.58467380 -3.039640 6.230050e-03\nI(trat^2)    0.02222876 0.01165948  1.906496 7.036247e-02\n\n----------------------------------------------------\nDeviations from regression\n----------------------------------------------------\n          Df       SSq       MSQ         F      p-value\nLinear     1 3196.2031 3196.2031 21.823293 0.0001899378\nQuadratic  1  544.5029  544.5029  3.717801 0.0697619482\nDeviation  3  509.6690  169.8897  1.159986 0.3523240106\nResidual  18 2636.2500  146.4583                       \n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n[[1]]\n```\n:::\n\n::: {.cell-output-display}\n![](Aula10_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n```{.r .cell-code}\ndata(\"phao\")\nwith(phao, polynomial(dose, comp, grau = 2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n----------------------------------------------------\nRegression Models\n----------------------------------------------------\n              Estimate Std. Error   t value     Pr(>|t|)\n(Intercept) 10.2097143 0.68981140 14.800733 6.427099e-13\ntrat         2.8822857 0.40856781  7.054608 4.456995e-07\nI(trat^2)   -0.3042857 0.04897332 -6.213296 2.971498e-06\n\n----------------------------------------------------\nDeviations from regression\n----------------------------------------------------\n          Df        SSq         MSQ          F      p-value\nLinear     1  40.140800  40.1408000 14.0529338 1.265122e-03\nQuadratic  1 103.700571 103.7005714 36.3046392 6.852202e-06\nDeviation  2   1.968229   0.9841143  0.3445296 7.126767e-01\nResidual  20  57.128000   2.8564000                        \n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n[[1]]\n```\n:::\n\n::: {.cell-output-display}\n![](Aula10_files/figure-html/unnamed-chunk-10-2.png){width=672}\n:::\n:::\n\n\ncoeficiente de correlação maior que coeficiente de regressão - precisa de relação de causa e efeito\n\nr2 - o quanto de y é explicado por x r - força de associação entre x e y\n\n# EC50 com pacote DRC\n\n### Importação\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(gsheet)\nsensib <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=465348652\")\n```\n:::\n\n\n### Visualização\n\n\n::: {.cell}\n\n```{.r .cell-code}\n sensib2 <- sensib %>% \n  group_by(code, dose) %>% \n  summarise(mean_germination = mean(germination))\n\nsensib2 %>%  \n  mutate(dose2=dose)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 120 × 4\n# Groups:   code [20]\n   code   dose mean_germination dose2\n   <chr> <dbl>            <dbl> <dbl>\n 1 152    0                48.5  0   \n 2 152    0.05             42    0.05\n 3 152    0.5              15.5  0.5 \n 4 152    1                 0.5  1   \n 5 152    5                 0    5   \n 6 152   10                 0   10   \n 7 153    0                49.5  0   \n 8 153    0.05             44.5  0.05\n 9 153    0.5               9    0.5 \n10 153    1                 8.5  1   \n# ℹ 110 more rows\n```\n:::\n\n```{.r .cell-code}\ngerm <- sensib2 |> \n  ggplot(aes(dose, mean_germination))+\n  geom_point()+\n  facet_wrap(~code)+\n  geom_smooth(method = \"lm\",\n              se = FALSE,\n              formula = y ~poly(x,2),\n              color = \"blue\")\n\nsensib %>% \n  group_by(code, dose) %>% \n  summarise(mean_germination = mean(germination)) %>% \n  ggplot(aes(dose, mean_germination))+\n  geom_point() +\n  facet_wrap(~code)\n```\n\n::: {.cell-output-display}\n![](Aula10_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n### Análise\n\nPara realizar a análise devemos filtrar o tratamento que queremos investigar e depois utilizamos a função `drm()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(drc)\nlibrary(MASS)\nlibrary(tidyverse)\n\nisolado165 <- sensib %>% \n  filter (code == \"165\")\n\ndrc1 <- drm (germination ~ dose, data = isolado165, fct = LL.3()) #ou WI.3\n\nAIC(drc1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 65.20663\n```\n:::\n\n```{.r .cell-code}\nplot(drc1)\n```\n\n::: {.cell-output-display}\n![](Aula10_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n\n```{.r .cell-code}\nED(drc1, 50, interval = \"delta\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nEstimated effective doses\n\n       Estimate Std. Error   Lower   Upper\ne:1:50  0.55840    0.10041 0.33125 0.78554\n```\n:::\n\n```{.r .cell-code}\nisolado186 <- sensib %>% \n  filter(code == \"186\")\n\ndrc2 <- drm(germination ~ dose, data = isolado186, fct = LL.3())\n\nAIC(drc2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 54.10205\n```\n:::\n\n```{.r .cell-code}\nplot(drc2)\n```\n\n::: {.cell-output-display}\n![](Aula10_files/figure-html/unnamed-chunk-13-2.png){width=672}\n:::\n\n```{.r .cell-code}\nED(drc2, 50, interval = \"delta\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nEstimated effective doses\n\n       Estimate Std. Error    Lower    Upper\ne:1:50 0.579757   0.017621 0.539896 0.619619\n```\n:::\n:::\n\n\n# EC50 com pacote ec50estimator\n\nNesse pacote é possível obter os valores de EC50 para todos os dados. A função utilizada é `estimate_EC50()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ec50estimator)\n\ndf_ec50 <- estimate_EC50 (mean_germination ~ dose, \n                          data = sensib,\n                          isolate_col = \"code\",\n                          interval = \"delta\",\n                          fct = drc::LL.3())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Isolates = c('FGT05', 'FGT06', 'FGT07', 'FGT28', 'FGT29', 'FGT33', 'FGT34', 'FGT35', 'FGT42', 'FGT43', '152', '153', '164', '165', '169', '170', '186', '187', '188', '189') did not produced ec50 estimates due to error during fitting procedure\"\n```\n:::\n\n```{.r .cell-code}\n#maior ec50 menos sensivel ao fungicida\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}