{
  "hash": "5562192dda9abab4aacaec707468b611",
  "result": {
    "markdown": "---\ntitle: \"Aula 6\"\nformat: html\neditor: visual\neditor_options: \n  chunk_output_type: console\n---\n\n\n# Inferencial\n\n## Dois grupos independentes\n\nPrimeiro precisamos importar o conjunto de dados utilizando o pacote gsheet.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(gsheet)\n\nmg <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=983033137\")\n```\n:::\n\n\n### Visualização\n\nUtilizamos um gráfico boxplot para uma visualização inicial dos dados e observação de características do conjunto.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nmg %>% \n  ggplot (aes(trat,comp))+\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n### Teste\n\nO teste t é utilizado somente quando há 2 grupos no conjunto de dados. Além disso, é necessário que sejam atendidas as premissas de distribuição normal e a variânça dos grupos sejam homogêneas.\n\nPara realizar o teste t, os dados precisam se apresentar em grupos separados (formato largo). Assim, é preciso utilizar a função `pivot_wider()` para o conjunto de dados mg. \nPara execução do teste t utilizamos a função `t.test()`. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nmg2 <- mg %>% \n  pivot_wider(names_from = trat,\n              values_from = comp)\n\nteste1 <- t.test(mg2$Mg2, mg2$control)\n\n\n#Para Utilizar o teste t quando as variânças não são homogêneas, deve adicionar var.qual = false \n\n#t.test(mg2$Mg2, mg2$control),\n#var.equal = FALSE\n```\n:::\n\n\nInterpretação: Pelo teste realizado, temos que a média de Mg2 é 10.52 e a média do controle é de 15.678. O valor do pvalor é menor que 0,05, então se rejeita Ho. O intervalo de confiança apresentado se refere a diferença entre as médias.\n\n### Verificar premissas\n\nA função `shapiro.test()` testa se a distribuição é normal. Se pvalor é maior que 0,05, então não rejeita Ho e assume que há normalidade.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(mg2$control)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  mg2$control\nW = 0.93886, p-value = 0.5404\n```\n:::\n\n```{.r .cell-code}\nshapiro.test(mg2$Mg2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  mg2$Mg2\nW = 0.97269, p-value = 0.9146\n```\n:::\n:::\n\n\nA função `var.test()` é utilizada para verificar se as variânças são homogêneas. Quando pvalor é maior que 0,05, então não rejeita Ho e assume que as variânças são homogêneas.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvar.test(mg2$control, mg2$Mg2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tF test to compare two variances\n\ndata:  mg2$control and mg2$Mg2\nF = 0.67654, num df = 9, denom df = 9, p-value = 0.5698\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n 0.1680428 2.7237436\nsample estimates:\nratio of variances \n         0.6765394 \n```\n:::\n:::\n\n\nUma outra forma de verificar normalidade é utilizando as funções gráficas `qqnorm()` e `qqline()`. Será um indicativo visual de normalidade, em que, se a maioria dos pontos estiverem sobre a linha há indicativo de normalidade.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nqqnorm(mg2$control)\nqqline(mg2$control)\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n### Texto complementar\n\nPara criar um texto a respeito dos resultados do teste, pode-se utilizar o pacote **report** com a função `report()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(report)\nreport (teste1)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Function `format_text()` is deprecated and will be removed in a future\n  release. Please use `text_format()` instead.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nEffect sizes were labelled following Cohen's (1988) recommendations.\n\nThe Welch Two Sample t-test testing the difference between mg2$Mg2 and\nmg2$control (mean of x = 10.52, mean of y = 15.68) suggests that the effect is\nnegative, statistically significant, and large (difference = -5.16, 95% CI\n[-6.49, -3.83], t(17.35) = -8.15, p < .001; Cohen's d = -3.65, 95% CI [-5.12,\n-2.14])\n```\n:::\n:::\n\n\n## Dois grupos dependentes\n\nQuando há dois grupos dependentes, deve ser realizado o teste t pareado.\n\n### Importação dos dados\n\n\n::: {.cell}\n\n```{.r .cell-code}\nescala <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=1729131173\")\n```\n:::\n\n\n### Visualização\n\n\n::: {.cell}\n\n```{.r .cell-code}\nescala %>% \n  ggplot (aes(assessment, acuracia)) +\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n### Modificação para formato largo\n\n\n::: {.cell}\n\n```{.r .cell-code}\nescala2 <- escala %>% \n  select(assessment, rater, acuracia) %>% \n  pivot_wider(names_from = assessment,\n              values_from = acuracia)\n```\n:::\n\n\n### Verificação de premissas e teste t\n\nNo caso do teste t pareado, adicionamos paired = TRUE ao script do teste. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Verificar se há normalidade\nshapiro.test(escala2$Unaided)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  escala2$Unaided\nW = 0.7748, p-value = 0.007155\n```\n:::\n\n```{.r .cell-code}\nshapiro.test(escala2$Aided1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  escala2$Aided1\nW = 0.92852, p-value = 0.4335\n```\n:::\n\n```{.r .cell-code}\n#Verificar se as varianças são homogêneas\nvar.test(escala2$Unaided, escala2$Aided1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tF test to compare two variances\n\ndata:  escala2$Unaided and escala2$Aided1\nF = 20.978, num df = 9, denom df = 9, p-value = 0.000106\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n  5.210754 84.459185\nsample estimates:\nratio of variances \n          20.97847 \n```\n:::\n\n```{.r .cell-code}\n# Realizado com os dados originais\nt.test(escala2$Aided1, escala2$Unaided,\n       paired = TRUE,\n       var.equal = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPaired t-test\n\ndata:  escala2$Aided1 and escala2$Unaided\nt = 4.4214, df = 9, p-value = 0.001668\nalternative hypothesis: true mean difference is not equal to 0\n95 percent confidence interval:\n 0.1147647 0.3552353\nsample estimates:\nmean difference \n          0.235 \n```\n:::\n:::\n\n\n## Teste não paramétrico\n\nNo teste não paramétrico não é necessário o atendimento das premissas para execução do teste estatístico.\n\n### Teste\n\nWilcox test é o equivalente não paramétrico do teste t. Utilizamos a função `wilcox.test()`. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nwilcox.test(escala2$Aided1,\n            escala2$Unaided,\n            paired = TRUE)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in wilcox.test.default(escala2$Aided1, escala2$Unaided, paired = TRUE):\nnão é possível computar o valor de p exato com o de desempate\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWilcoxon signed rank test with continuity correction\n\ndata:  escala2$Aided1 and escala2$Unaided\nV = 55, p-value = 0.005889\nalternative hypothesis: true location shift is not equal to 0\n```\n:::\n:::\n\n\n## Três ou mais grupos de dados\n\nQuando há três ou mais grupos de dados, realizamos uma análise de variânça (ANOVA). A ANOVA irá verificar se pelo menos uma das médias difere das demais.\n\n### Importação dos dados\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmicelial <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=959387827\")\n```\n:::\n\n\n### Visualização\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmicelial %>%  \n  ggplot (aes(especie, tcm)) +\n  geom_jitter(width = 0.05)\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n### ANOVA \n\nOs dados devem ser ajustados para o modelo de ANOVA por meio da função `lm()` e o teste em si é realizado por meio da função `anova()`.\nA função `summary` permite a visualização de um resumo estatistico do teste. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nm1 <- lm(tcm ~ especie, data = micelial)\n\nanova(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: tcm\n          Df  Sum Sq Mean Sq F value    Pr(>F)    \nespecie    4 1.46958 0.36739  19.629 2.028e-07 ***\nResiduals 25 0.46792 0.01872                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nsummary(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = tcm ~ especie, data = micelial)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.23667 -0.09667  0.01583  0.08833  0.28333 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  1.57167    0.05585  28.140  < 2e-16 ***\nespecieFaus -0.33500    0.07899  -4.241 0.000266 ***\nespecieFcor -0.25000    0.07899  -3.165 0.004047 ** \nespecieFgra -0.66000    0.07899  -8.356 1.05e-08 ***\nespecieFmer -0.14500    0.07899  -1.836 0.078317 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1368 on 25 degrees of freedom\nMultiple R-squared:  0.7585,\tAdjusted R-squared:  0.7199 \nF-statistic: 19.63 on 4 and 25 DF,  p-value: 2.028e-07\n```\n:::\n\n```{.r .cell-code}\n# coloca -1 após a especie para ter as médias diretamente\n```\n:::\n\n\n### Verificação de premissas\n\nNa análise de variânça utilizamos a função `shapiro.test()` para verificação da normalidade e a função `bartlett.test()` para verificação da homogeneidade da variânça. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(m1$residuals)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  m1$residuals\nW = 0.9821, p-value = 0.8782\n```\n:::\n\n```{.r .cell-code}\nbartlett.test(tcm ~ especie, data = micelial)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tBartlett test of homogeneity of variances\n\ndata:  tcm by especie\nBartlett's K-squared = 4.4367, df = 4, p-value = 0.3501\n```\n:::\n:::\n\n\nNomenclaturas ANOVA: sum sq = somatório dos quadrados; df = graus de liberdade; mean sq = média dos quadrados -\\> sum sq / df; F value = valor F -\\> Mean sq fator / Mean sq residuo\n\n### Grupos distintos \n\nPara verificar os grupos que são distintos estatisticamente, primeiro calculamos as médias dos grupos por meio da função `emmeans()` do pacote **emmeans**. Depois utilizamos a função `cld()`do pacote **multcomp** para visualizar os grupamentos distintos. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(emmeans)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWelcome to emmeans.\nCaution: You lose important information if you filter this package's results.\nSee '? untidy'\n```\n:::\n\n```{.r .cell-code}\nmedias1 <- emmeans(m1, ~ especie)\n\nlibrary(multcomp)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nCarregando pacotes exigidos: mvtnorm\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nCarregando pacotes exigidos: survival\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nCarregando pacotes exigidos: TH.data\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nCarregando pacotes exigidos: MASS\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'MASS'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:dplyr':\n\n    select\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'TH.data'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:MASS':\n\n    geyser\n```\n:::\n\n```{.r .cell-code}\nlibrary(multcompView)\ncld (medias1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n especie emmean     SE df lower.CL upper.CL .group\n Fgra     0.912 0.0559 25    0.797     1.03  1    \n Faus     1.237 0.0559 25    1.122     1.35   2   \n Fcor     1.322 0.0559 25    1.207     1.44   2   \n Fmer     1.427 0.0559 25    1.312     1.54   23  \n Fasi     1.572 0.0559 25    1.457     1.69    3  \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 5 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n:::\n:::\n\n\n### Outras formas de verificação das premissas\n\nPodemos analisar de forma gráfica as premissas por meio da função `plot (simulateResiduals())` do pacote **DHARMa** ou pela função `check_model()` do pacote **see**.\n\nTambém podemos verificar as premissas diretamente pelas funções `check_normality()` e `check_heteroscedasticity()` do pacote **performance**. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary (DHARMa)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nThis is DHARMa 0.4.6. For overview type '?DHARMa'. For recent changes, type news(package = 'DHARMa')\n```\n:::\n\n```{.r .cell-code}\nplot(simulateResiduals(m1))\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n\n```{.r .cell-code}\nlibrary(performance)\ncheck_normality(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: residuals appear as normally distributed (p = 0.878).\n```\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nOK: Error variance appears to be homoscedastic (p = 0.880).\n```\n:::\n\n```{.r .cell-code}\nlibrary(see)\ncheck_model(m1)\n```\n\n::: {.cell-output-display}\n![](Aula6_files/figure-html/unnamed-chunk-18-2.png){width=672}\n:::\n:::\n",
    "supporting": [
      "Aula6_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}