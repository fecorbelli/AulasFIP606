{"title":"Aula4","markdown":{"yaml":{"title":"Aula4","format":"html","editor":"visual","message":false,"warning":false},"headingText":"Usando datapasta","containsRefs":false,"markdown":"\n\n\nO comando **datapasta** permite copiar vetores de outros locais e colar diretamente no programa. As opções de colagem se encontram no menu \"Addins\".\n\n```{r}\n\ndat <- data.frame(\n  stringsAsFactors = FALSE,\n              trat = c(\"Mg2\",\"Mg2\",\"Mg2\",\"Mg2\",\n                       \"Mg2\",\"Mg2\",\"Mg2\",\"Mg2\",\"Mg2\",\"Mg2\",\"control\",\n                       \"control\",\"control\",\"control\",\"control\",\"control\",\"control\",\n                       \"control\",\"control\",\"control\"),\n               rep = c(1L,2L,3L,4L,5L,6L,7L,8L,\n                       9L,10L,1L,2L,3L,4L,5L,6L,7L,8L,9L,10L),\n              comp = c(9,125,10,8,132,11,108,95,\n                       108,104,1372,1591,157,142,159,1654,18,144,\n                       1641,16))\n\ndat\n```\n\nExemplo utilizando os dados da tabela \"dados.diversos\" e o comando \"paste as tribble\".\n\n```{r}\ndat2 <- tibble::tribble(\n              ~trat, ~rep, ~comp,\n              \"Mg2\",   1L,     9,\n              \"Mg2\",   2L,   125,\n              \"Mg2\",   3L,    10,\n              \"Mg2\",   4L,     8,\n              \"Mg2\",   5L,   132,\n              \"Mg2\",   6L,    11,\n              \"Mg2\",   7L,   108,\n              \"Mg2\",   8L,    95,\n              \"Mg2\",   9L,   108,\n              \"Mg2\",  10L,   104,\n          \"control\",   1L,  1372,\n          \"control\",   2L,  1591,\n          \"control\",   3L,   157,\n          \"control\",   4L,   142,\n          \"control\",   5L,   159,\n          \"control\",   6L,  1654,\n          \"control\",   7L,    18,\n          \"control\",   8L,   144,\n          \"control\",   9L,  1641,\n          \"control\",  10L,    16\n          )\n\ndat2\n```\n\nExemplo utilizando o comando \"paste as tribble\" a partir de dados disponíveis em uma página na internet.\n\n```{r}\npop <- tibble::tribble(\n  ~`Pos.\tPaís\tPopulação\tÁrea.(km²)\tDensidade.(habitantes.por.km²)`,\n                                \"0\\t Macau\\t649 335\\t28,6\\t22 402\",\n                                \"1\\t Mônaco\\t37 308\\t2,02\\t18 713\",\n                 \"2\\tSingapura Singapura\\t5 638 700\\t716,1\\t7 874\",\n                          \"3\\t Hong Kong\\t7 184 000\\t1 104\\t6 544\",\n                                  \"4\\t Vaticano\\t825\\t0,49\\t1 891\",\n                                  \"5\\t Malta\\t417 617\\t316\\t1 321\",\n                               \"6\\t Maldivas\\t427 756\\t300\\t1 426\",\n           \"7\\tBangladesh Bangladesh\\t163 220 762\\t144 000\\t1 113\",\n                           \"8\\t Bahrein\\t1 442 659[1]\\t665\\t1 035\",\n                                 \"9\\t Barbados\\t279 254\\t431\\t647\",\n                            \"10\\t Taiwan\\t22 894 384\\t35 980\\t636\",\n                                                          \"︀慴됨捈ݡ退\",\n                                                           \"\\001\"\n  )\n\n\n\n```\n\n# Remodelar dados para formato longo\n\nQuando os dados se encontram em formato largo é interessante fazer a remodelação dos dados para posteriormente criar um gráfico. Para isso utilizamos a função `pivot_longer()`.\n\n```{r}\n\nlibrary(tidyverse)\npepper <- \n  tribble(\n   ~t,  ~`1`,  ~`2`,  ~`3`,\n   0,  0.08, 0.001, 0.001,\n   7,  0.13,  0.01, 0.001,\n  14,  0.78,  0.09,  0.01,\n  21,  0.92,  0.25,  0.05,\n  28,  0.99,   0.8,  0.18,\n  35, 0.995,  0.98,  0.34,\n  42, 0.999,  0.99,  0.48,\n  49, 0.999, 0.999,  0.74\n  ) \npepper %>% \n  pivot_longer(2:4,\n               names_to = \"epidemic\",\n               values_to = \"inc\")\n```\n\n## Visualização gráfica\n\n```{r}\n\npepper %>% \n  pivot_longer(2:4,\n               names_to = \"epidemic\",\n               values_to = \"inc\") %>% \nggplot(aes(t,inc, color = epidemic))+\n  geom_point()\n```\n\n# Anotações em gráficos\n\nPara adicionar textos aos gráficos em posições específicas podemos utilizar a função `annotate()` com os argumentos geom = \"text\", x= e y= para o posicionamento e o que deve ser adicionado em label =.\n\n```{r}\npepper %>% \n  pivot_longer(2:4,\n               names_to = \"epidemic\",\n               values_to = \"inc\") %>% \nggplot(aes(t,inc, color = epidemic))+\n  geom_point()+\n  geom_line()+\n  annotate(geom = \"text\",\n           x = 12,\n           y = 0.75,\n           label = \"1\")+\n annotate(geom = \"text\",\n           x = 25,\n           y = 0.75,\n           label = \"2\")+\n annotate(geom = \"text\",\n           x = 45,\n           y = 0.75,\n           label = \"3\")+\n  theme(legend.position = \"none\")\n\n#ultima linha para retirar a legenda do gráfico e evitar a redundância\n```\n\n# Tabela de Contingência\n\nPara contabilizar o número de observaçõs de detrminado dado podemos utilizar a função `count()` ou `tabyl()` do pacote janitor.\n\n```{r}\ncr <- read_csv(\"https://raw.githubusercontent.com/emdelponte/paper-coffee-rust-Ethiopia/master/data/survey_clean.csv\")\n\n# formato longo\ncr %>%  \n  count(region, zone)\n\nlibrary(janitor)\n\n# formato largo\ncr %>% \n  tabyl(region, zone)\n\n# formato longo\ncr %>% \n  tabyl(zone, region)\n\n```\n\n# Visualização\n\nPara criação de um gráfico de barras utilizamos a função `geom_col()`. Para visualização dos grupos lado a lado utilizamos position = \"dodge2\", já para visualização empilhada utilizamos position = \"stack\".\n\n```{r}\n\nlibrary(ggthemes)\ncr %>%  \n  count(farm_management, cultivar) %>% \n  ggplot(aes(cultivar, n, fill = farm_management,\n             label = n))+\n  geom_col(position = \"dodge2\")+\n  scale_fill_canva()+\n  theme_bw()+\n  theme(strip.text.x = element_blank(),\nlegend.position = \"top\") +\n  geom_text(position = position_dodge(width = 1))+\n  facet_wrap(~cultivar, scales = \"free_x\")\n\n\n```\n\n# Gráfico barra de erro\n\nPara criar um gráfico de barra de erro utilizamos a função `geom_errobar()`. Devemos construir antes dessa função uma camada com os dados de média e desvio padrão do conjunto de dados.\n\n```{r}\nlibrary(gsheet)\n\nmg <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=983033137#gid=983033137\")\n\nmg %>% \n  group_by(trat) %>% \n  summarise (mean_comp = mean(comp),\n             sd_comp = sd(comp)) %>% \n  ggplot(aes(trat,mean_comp))+\n  #geom_col(fill = \"steelblue\", width = 0.5)+\n  geom_point(size = 3)+\n  ylim(0,20)+\ngeom_errorbar(aes(ymin = mean_comp - sd_comp,\n                  ymax = mean_comp + sd_comp),\n             width = 0.02)+\n  #para adicionar * de estatisticamente diferente\n  annotate(geom = \"text\",\n           x = 1, y = 17.5,\n           label = \"*\")\n\nmg %>% \n  ggplot(aes(trat,comp))+\n  geom_jitter(width = 0.1)\n\n\n```\n","srcMarkdownNoYaml":"\n\n# Usando datapasta\n\nO comando **datapasta** permite copiar vetores de outros locais e colar diretamente no programa. As opções de colagem se encontram no menu \"Addins\".\n\n```{r}\n\ndat <- data.frame(\n  stringsAsFactors = FALSE,\n              trat = c(\"Mg2\",\"Mg2\",\"Mg2\",\"Mg2\",\n                       \"Mg2\",\"Mg2\",\"Mg2\",\"Mg2\",\"Mg2\",\"Mg2\",\"control\",\n                       \"control\",\"control\",\"control\",\"control\",\"control\",\"control\",\n                       \"control\",\"control\",\"control\"),\n               rep = c(1L,2L,3L,4L,5L,6L,7L,8L,\n                       9L,10L,1L,2L,3L,4L,5L,6L,7L,8L,9L,10L),\n              comp = c(9,125,10,8,132,11,108,95,\n                       108,104,1372,1591,157,142,159,1654,18,144,\n                       1641,16))\n\ndat\n```\n\nExemplo utilizando os dados da tabela \"dados.diversos\" e o comando \"paste as tribble\".\n\n```{r}\ndat2 <- tibble::tribble(\n              ~trat, ~rep, ~comp,\n              \"Mg2\",   1L,     9,\n              \"Mg2\",   2L,   125,\n              \"Mg2\",   3L,    10,\n              \"Mg2\",   4L,     8,\n              \"Mg2\",   5L,   132,\n              \"Mg2\",   6L,    11,\n              \"Mg2\",   7L,   108,\n              \"Mg2\",   8L,    95,\n              \"Mg2\",   9L,   108,\n              \"Mg2\",  10L,   104,\n          \"control\",   1L,  1372,\n          \"control\",   2L,  1591,\n          \"control\",   3L,   157,\n          \"control\",   4L,   142,\n          \"control\",   5L,   159,\n          \"control\",   6L,  1654,\n          \"control\",   7L,    18,\n          \"control\",   8L,   144,\n          \"control\",   9L,  1641,\n          \"control\",  10L,    16\n          )\n\ndat2\n```\n\nExemplo utilizando o comando \"paste as tribble\" a partir de dados disponíveis em uma página na internet.\n\n```{r}\npop <- tibble::tribble(\n  ~`Pos.\tPaís\tPopulação\tÁrea.(km²)\tDensidade.(habitantes.por.km²)`,\n                                \"0\\t Macau\\t649 335\\t28,6\\t22 402\",\n                                \"1\\t Mônaco\\t37 308\\t2,02\\t18 713\",\n                 \"2\\tSingapura Singapura\\t5 638 700\\t716,1\\t7 874\",\n                          \"3\\t Hong Kong\\t7 184 000\\t1 104\\t6 544\",\n                                  \"4\\t Vaticano\\t825\\t0,49\\t1 891\",\n                                  \"5\\t Malta\\t417 617\\t316\\t1 321\",\n                               \"6\\t Maldivas\\t427 756\\t300\\t1 426\",\n           \"7\\tBangladesh Bangladesh\\t163 220 762\\t144 000\\t1 113\",\n                           \"8\\t Bahrein\\t1 442 659[1]\\t665\\t1 035\",\n                                 \"9\\t Barbados\\t279 254\\t431\\t647\",\n                            \"10\\t Taiwan\\t22 894 384\\t35 980\\t636\",\n                                                          \"︀慴됨捈ݡ退\",\n                                                           \"\\001\"\n  )\n\n\n\n```\n\n# Remodelar dados para formato longo\n\nQuando os dados se encontram em formato largo é interessante fazer a remodelação dos dados para posteriormente criar um gráfico. Para isso utilizamos a função `pivot_longer()`.\n\n```{r}\n\nlibrary(tidyverse)\npepper <- \n  tribble(\n   ~t,  ~`1`,  ~`2`,  ~`3`,\n   0,  0.08, 0.001, 0.001,\n   7,  0.13,  0.01, 0.001,\n  14,  0.78,  0.09,  0.01,\n  21,  0.92,  0.25,  0.05,\n  28,  0.99,   0.8,  0.18,\n  35, 0.995,  0.98,  0.34,\n  42, 0.999,  0.99,  0.48,\n  49, 0.999, 0.999,  0.74\n  ) \npepper %>% \n  pivot_longer(2:4,\n               names_to = \"epidemic\",\n               values_to = \"inc\")\n```\n\n## Visualização gráfica\n\n```{r}\n\npepper %>% \n  pivot_longer(2:4,\n               names_to = \"epidemic\",\n               values_to = \"inc\") %>% \nggplot(aes(t,inc, color = epidemic))+\n  geom_point()\n```\n\n# Anotações em gráficos\n\nPara adicionar textos aos gráficos em posições específicas podemos utilizar a função `annotate()` com os argumentos geom = \"text\", x= e y= para o posicionamento e o que deve ser adicionado em label =.\n\n```{r}\npepper %>% \n  pivot_longer(2:4,\n               names_to = \"epidemic\",\n               values_to = \"inc\") %>% \nggplot(aes(t,inc, color = epidemic))+\n  geom_point()+\n  geom_line()+\n  annotate(geom = \"text\",\n           x = 12,\n           y = 0.75,\n           label = \"1\")+\n annotate(geom = \"text\",\n           x = 25,\n           y = 0.75,\n           label = \"2\")+\n annotate(geom = \"text\",\n           x = 45,\n           y = 0.75,\n           label = \"3\")+\n  theme(legend.position = \"none\")\n\n#ultima linha para retirar a legenda do gráfico e evitar a redundância\n```\n\n# Tabela de Contingência\n\nPara contabilizar o número de observaçõs de detrminado dado podemos utilizar a função `count()` ou `tabyl()` do pacote janitor.\n\n```{r}\ncr <- read_csv(\"https://raw.githubusercontent.com/emdelponte/paper-coffee-rust-Ethiopia/master/data/survey_clean.csv\")\n\n# formato longo\ncr %>%  \n  count(region, zone)\n\nlibrary(janitor)\n\n# formato largo\ncr %>% \n  tabyl(region, zone)\n\n# formato longo\ncr %>% \n  tabyl(zone, region)\n\n```\n\n# Visualização\n\nPara criação de um gráfico de barras utilizamos a função `geom_col()`. Para visualização dos grupos lado a lado utilizamos position = \"dodge2\", já para visualização empilhada utilizamos position = \"stack\".\n\n```{r}\n\nlibrary(ggthemes)\ncr %>%  \n  count(farm_management, cultivar) %>% \n  ggplot(aes(cultivar, n, fill = farm_management,\n             label = n))+\n  geom_col(position = \"dodge2\")+\n  scale_fill_canva()+\n  theme_bw()+\n  theme(strip.text.x = element_blank(),\nlegend.position = \"top\") +\n  geom_text(position = position_dodge(width = 1))+\n  facet_wrap(~cultivar, scales = \"free_x\")\n\n\n```\n\n# Gráfico barra de erro\n\nPara criar um gráfico de barra de erro utilizamos a função `geom_errobar()`. Devemos construir antes dessa função uma camada com os dados de média e desvio padrão do conjunto de dados.\n\n```{r}\nlibrary(gsheet)\n\nmg <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit?gid=983033137#gid=983033137\")\n\nmg %>% \n  group_by(trat) %>% \n  summarise (mean_comp = mean(comp),\n             sd_comp = sd(comp)) %>% \n  ggplot(aes(trat,mean_comp))+\n  #geom_col(fill = \"steelblue\", width = 0.5)+\n  geom_point(size = 3)+\n  ylim(0,20)+\ngeom_errorbar(aes(ymin = mean_comp - sd_comp,\n                  ymax = mean_comp + sd_comp),\n             width = 0.02)+\n  #para adicionar * de estatisticamente diferente\n  annotate(geom = \"text\",\n           x = 1, y = 17.5,\n           label = \"*\")\n\nmg %>% \n  ggplot(aes(trat,comp))+\n  geom_jitter(width = 0.1)\n\n\n```\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"Aula4.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.450","editor":"visual","theme":"cosmo","title":"Aula4","message":false},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}